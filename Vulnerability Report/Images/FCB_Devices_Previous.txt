// FCB_Devices_Previous
let
    Source =
        Csv.Document(
            File.Contents(
                "C:\Users\PhillipsJacob\OneDrive - First Carolina Bank\Documents\Vulnerability Exports\DefenderExports\FCB\fcb_devices_previous.csv"
            ),
            [Delimiter = ",", Columns = 32, Encoding = 65001, QuoteStyle = QuoteStyle.None]
        ),

    #"Promoted Headers" =
        Table.PromoteHeaders(Source, [PromoteAllScalars = true]),

    #"Changed Type" =
        Table.TransformColumnTypes(
            #"Promoted Headers",
            {
                {"Device ID", type text},
                {"Device Name", type text},
                {"Device Category", type text},
                {"Device Type", type text},
                {"Device Subtype", type text},
                {"Discovery sources", type text},
                {"Domain", type text},
                {"AAD Device Id", type text},
                {"First Seen", type datetime},
                {"Last device update", type datetime},
                {"OS Platform", type text},
                {"OS Distribution", type text},
                {"OS Version", type text},
                {"OS Build", Int64.Type},
                {"Windows 10 Version", type text},
                {"Tags", type text},
                {"Group", Int64.Type},
                {"Is AAD Joined", type logical},
                {"Device IPs", type text},
                {"Device MACs", type text},
                {"Risk Level", type text},
                {"Exposure Level", type text},
                {"Health Status", type text},
                {"Onboarding Status", type text},
                {"Device Role", type text},
                {"Cloud Platforms", type text},
                {"Is Internet Facing", type logical},
                {"Enrollment Status Code", type text},
                {"Managed By", type text},
                {"Enrollment Status", type text},
                {"Vendor", type text},
                {"Model", type text}
            }
        ),

    // Drop all the extra columns you don't need, same pattern as Getback/BMTX previous
    #"Removed Columns" =
        Table.RemoveColumns(
            #"Changed Type",
            {
                "Device Category",
                "Device Type",
                "Device Subtype",
                "Discovery sources",
                "Domain",
                "AAD Device Id",
                "First Seen",
                "Last device update",
                "OS Version",
                "OS Build",
                "Windows 10 Version",
                "Group",
                "Is AAD Joined",
                "Device IPs",
                "Device MACs",
                "Risk Level",
                "Exposure Level",
                "Health Status",
                "Onboarding Status",
                "Device Role",
                "Cloud Platforms",
                "Is Internet Facing",
                "Enrollment Status Code",
                "Managed By",
                "Enrollment Status",
                "Vendor",
                "Model"
            }
        ),

    // Tag these rows as FCB
    #"Added Custom" =
        Table.AddColumn(#"Removed Columns", "Tenant", each "FCB"),

    // Keep the same column layout as the other *_Devices_Previous queries
    #"Reordered Columns" =
        Table.ReorderColumns(
            #"Added Custom",
            {"Tenant", "Device ID", "Device Name", "OS Platform", "OS Distribution", "Tags"}
        )
in
    #"Reordered Columns"