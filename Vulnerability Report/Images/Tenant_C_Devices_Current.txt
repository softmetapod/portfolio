let
    Source = Csv.Document(File.Contents("C:\Users\User\Documents\Vulnerability Exports\DefenderExports\Tenant_C\tenant_c_devices_current.csv"),[Delimiter=",", Columns=32, Encoding=65001, QuoteStyle=QuoteStyle.None]),
    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"Device ID", type text}, {"Device Name", type text}, {"Device Category", type text}, {"Device Type", type text}, {"Device Subtype", type text}, {"Discovery sources", type text}, {"Domain", type text}, {"AAD Device Id", type text}, {"First Seen", type datetime}, {"Last device update", type datetime}, {"OS Platform", type text}, {"OS Distribution", type text}, {"OS Version", type text}, {"OS Build", Int64.Type}, {"Windows 10 Version", type text}, {"Tags", type text}, {"Group", Int64.Type}, {"Is AAD Joined", type logical}, {"Device IPs", type text}, {"Device MACs", type text}, {"Risk Level", type text}, {"Exposure Level", type text}, {"Health Status", type text}, {"Onboarding Status", type text}, {"Device Role", type text}, {"Cloud Platforms", type text}, {"Is Internet Facing", type logical}, {"Enrollment Status Code", type text}, {"Managed By", type text}, {"Enrollment Status", type text}, {"Vendor", type text}, {"Model", type text}}),
    #"Removed Columns" = Table.RemoveColumns(#"Changed Type",{"Device Category", "Device Type", "Device Subtype", "Discovery sources", "Domain", "AAD Device Id", "First Seen", "Last device update", "OS Version", "OS Build", "Windows 10 Version", "Group", "Is AAD Joined", "Device IPs", "Device MACs", "Risk Level", "Exposure Level", "Health Status", "Onboarding Status", "Device Role", "Cloud Platforms", "Is Internet Facing", "Enrollment Status Code", "Managed By", "Enrollment Status", "Vendor", "Model"}),
    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"Device ID", "DeviceId"}, {"Device Name", "DeviceName"}, {"OS Platform", "OSPlatform"}}),
    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns",{"OS Distribution"}),
    #"Added Custom" = Table.AddColumn(#"Removed Columns1", "Tenant", each "Tenant_C"),
    #"Reordered Columns" = Table.ReorderColumns(#"Added Custom",{"Tenant", "DeviceId", "DeviceName", "OSPlatform", "Tags"}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Reordered Columns",{{"Tenant", type text}}),
    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type1",{{"DeviceId", "Device ID"}, {"DeviceName", "Device Name"}, {"OSPlatform", "OS Platform"}})
in
    #"Renamed Columns1"
